---
description: "ç¨‹å¼ç¢¼å“è³ªè¦ç¯„ - ç¢ºä¿ç¨‹å¼ç¢¼å“è³ªèˆ‡å¯ç¶­è­·æ€§"
type: "Auto Attached"
pattern: "**/*.{js,jsx,ts,tsx}"
version: "1.0.0"
author: "s123104"
last_updated: "2025-08-16T18:22:20+08:00"
---

# Click Fun ç¨‹å¼ç¢¼å“è³ªè¦ç¯„

## ğŸ¯ å“è³ªç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | ç•¶å‰å€¼ | ç‹€æ…‹ |
|------|-------|--------|------|
| **æ¸¬è©¦è¦†è“‹ç‡** | â‰¥ 80% | 85% | âœ… |
| **ESLint éŒ¯èª¤** | 0 | 0 | âœ… |
| **å¾ªç’°è¤‡é›œåº¦** | â‰¤ 10 | 8 | âœ… |
| **æŠ€è¡“å‚µå‹™** | â‰¤ 15% | 12% | âœ… |

## ğŸ” ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥

### è‡ªå‹•åŒ–æª¢æŸ¥å·¥å…·

```bash
# å®Œæ•´å“è³ªæª¢æŸ¥
npm run quality:check

# ç¨‹å¼ç¢¼æ ¼å¼åŒ–
npm run quality:fix

# ESLint æª¢æŸ¥
npm run lint:check

# Prettier æ ¼å¼æª¢æŸ¥
npm run format:check
```

### å“è³ªé–€æª»

æ¯æ¬¡æäº¤å‰å¿…é ˆé€šéä»¥ä¸‹æª¢æŸ¥ï¼š

```yaml
quality_gates:
  linting:
    eslint_errors: 0
    eslint_warnings: "â‰¤ 5"
    
  formatting:
    prettier_issues: 0
    
  complexity:
    cyclomatic_complexity: "â‰¤ 10"
    cognitive_complexity: "â‰¤ 15"
    
  testing:
    unit_coverage: "â‰¥ 80%"
    integration_coverage: "â‰¥ 70%"
    
  performance:
    bundle_size: "â‰¤ 500KB"
    lighthouse_score: "â‰¥ 90"
```

## ğŸ“ ç¨‹å¼ç¢¼åº¦é‡æ¨™æº–

### è¤‡é›œåº¦æ§åˆ¶

```javascript
// âœ… è‰¯å¥½çš„å‡½æ•¸è¤‡é›œåº¦ (â‰¤ 10)
function processGameInput(input) {
  if (!input) return null;
  if (!input.type) return null;
  
  switch (input.type) {
    case 'click':
      return handleClick(input);
    case 'touch':
      return handleTouch(input);
    default:
      return handleDefault(input);
  }
}

// âŒ éé«˜çš„è¤‡é›œåº¦ (> 10)
function processComplexGameLogic(state, input, settings, effects) {
  if (state && input && settings && effects) {
    if (state.isPlaying) {
      if (input.type === 'click') {
        if (settings.soundEnabled) {
          if (effects.lightning) {
            if (state.score > 100) {
              // å¤ªå¤šå±¤çš„å·¢ç‹€é‚è¼¯
            }
          }
        }
      }
    }
  }
}
```

### å‡½æ•¸é•·åº¦é™åˆ¶

```javascript
// âœ… ä¿æŒå‡½æ•¸ç°¡æ½” (â‰¤ 50 è¡Œ)
function updateScore(points) {
  const currentScore = GameState.getScore();
  const newScore = currentScore + points;
  
  GameState.setScore(newScore);
  updateScoreDisplay(newScore);
  checkAchievements(newScore);
  
  return newScore;
}

// å¦‚æœå‡½æ•¸éé•·ï¼Œæ‡‰è©²æ‹†åˆ†
function handleGameEnd() {
  const results = calculateResults();
  const achievements = checkAchievements(results);
  const leaderboard = updateLeaderboard(results);
  
  displayResults(results, achievements, leaderboard);
  saveGameData(results);
  scheduleNextGame();
}
```

## ğŸ§ª æ¸¬è©¦å“è³ªæ¨™æº–

### æ¸¬è©¦çµæ§‹

```javascript
// âœ… æ¨™æº–çš„æ¸¬è©¦çµæ§‹
describe('éŠæˆ²åˆ†æ•¸è¨ˆç®—', () => {
  describe('ç•¶éŠæˆ²é€²è¡Œä¸­', () => {
    beforeEach(() => {
      // è¨­å®šæ¸¬è©¦ç’°å¢ƒ
      GameState.reset();
      GameState.start();
    });
    
    test('æ‡‰è©²æ­£ç¢ºç´¯åŠ é»æ“Šåˆ†æ•¸', () => {
      // Given - æº–å‚™æ¸¬è©¦è³‡æ–™
      const initialScore = 0;
      const clickPoints = 5;
      
      // When - åŸ·è¡Œæ¸¬è©¦å‹•ä½œ
      const result = GameManager.addScore(clickPoints);
      
      // Then - é©—è­‰çµæœ
      expect(result).toBe(5);
      expect(GameState.getScore()).toBe(5);
    });
    
    test('æ‡‰è©²è§¸ç™¼åˆ†æ•¸é‡Œç¨‹ç¢‘äº‹ä»¶', () => {
      // Given
      const scoreBeforeMilestone = 95;
      const clickPoints = 10;
      GameState.setScore(scoreBeforeMilestone);
      
      // When
      const milestoneEvent = jest.fn();
      GameManager.onMilestone(milestoneEvent);
      GameManager.addScore(clickPoints);
      
      // Then
      expect(milestoneEvent).toHaveBeenCalledWith(100);
    });
  });
});
```

### æ¸¬è©¦è¦†è“‹ç‡è¦æ±‚

```yaml
coverage_requirements:
  statements: "â‰¥ 80%"
  branches: "â‰¥ 75%"
  functions: "â‰¥ 85%"
  lines: "â‰¥ 80%"
  
critical_paths:
  game_logic: "100%"
  score_calculation: "100%"
  user_input: "100%"
  storage_operations: "95%"
```

### Mock èˆ‡ Stub æœ€ä½³å¯¦è¸

```javascript
// âœ… é©ç•¶çš„ Mock ä½¿ç”¨
describe('éŸ³æ•ˆç®¡ç†', () => {
  let mockAudioContext;
  
  beforeEach(() => {
    mockAudioContext = {
      createOscillator: jest.fn(() => ({
        connect: jest.fn(),
        start: jest.fn(),
        stop: jest.fn()
      })),
      createGain: jest.fn(() => ({
        connect: jest.fn(),
        gain: { value: 1 }
      }))
    };
    
    global.AudioContext = jest.fn(() => mockAudioContext);
  });
  
  test('æ‡‰è©²æ’­æ”¾é»æ“ŠéŸ³æ•ˆ', () => {
    // Given
    const audioManager = new AudioManager();
    
    // When
    audioManager.playClickSound();
    
    // Then
    expect(mockAudioContext.createOscillator).toHaveBeenCalled();
  });
});
```

## ğŸ“Š æ•ˆèƒ½ç›£æ§

### é—œéµæ•ˆèƒ½æŒ‡æ¨™ (KPI)

```javascript
// âœ… æ•ˆèƒ½ç›£æ§å¯¦ä½œ
class PerformanceMonitor {
  static measureFunctionPerformance(fn, name) {
    return function(...args) {
      const start = performance.now();
      const result = fn.apply(this, args);
      const end = performance.now();
      
      console.log(`${name} åŸ·è¡Œæ™‚é–“: ${end - start}ms`);
      
      // è¨˜éŒ„åˆ°åˆ†æç³»çµ±
      this.recordMetric(name, end - start);
      
      return result;
    };
  }
  
  static recordMetric(name, value) {
    // ç™¼é€åˆ°ç›£æ§ç³»çµ±
    if (typeof gtag !== 'undefined') {
      gtag('event', 'performance_metric', {
        metric_name: name,
        metric_value: value
      });
    }
  }
}

// ä½¿ç”¨æ•ˆèƒ½ç›£æ§
const optimizedUpdateScore = PerformanceMonitor.measureFunctionPerformance(
  GameManager.updateScore,
  'updateScore'
);
```

### è¨˜æ†¶é«”æ´©æ¼é˜²è­·

```javascript
// âœ… é©ç•¶çš„äº‹ä»¶ç›£è½å™¨ç®¡ç†
class GameEventManager {
  constructor() {
    this.listeners = new Map();
  }
  
  addEventListener(element, event, handler) {
    const key = `${element}-${event}`;
    
    // ç§»é™¤èˆŠçš„ç›£è½å™¨
    if (this.listeners.has(key)) {
      element.removeEventListener(event, this.listeners.get(key));
    }
    
    // æ–°å¢æ–°çš„ç›£è½å™¨
    element.addEventListener(event, handler);
    this.listeners.set(key, handler);
  }
  
  cleanup() {
    // æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›£è½å™¨
    this.listeners.forEach((handler, key) => {
      const [element, event] = key.split('-');
      element.removeEventListener(event, handler);
    });
    this.listeners.clear();
  }
}
```

## ğŸ”’ å®‰å…¨æ€§æª¢æŸ¥

### è¼¸å…¥é©—è­‰

```javascript
// âœ… åš´æ ¼çš„è¼¸å…¥é©—è­‰
class InputValidator {
  static validateScore(score) {
    // å‹åˆ¥æª¢æŸ¥
    if (typeof score !== 'number') {
      throw new TypeError('åˆ†æ•¸å¿…é ˆæ˜¯æ•¸å­—å‹åˆ¥');
    }
    
    // ç¯„åœæª¢æŸ¥
    if (!Number.isFinite(score)) {
      throw new RangeError('åˆ†æ•¸å¿…é ˆæ˜¯æœ‰é™æ•¸å­—');
    }
    
    // åˆç†æ€§æª¢æŸ¥
    if (score < 0) {
      throw new RangeError('åˆ†æ•¸ä¸èƒ½ç‚ºè² æ•¸');
    }
    
    if (score > 10000) {
      console.warn('åˆ†æ•¸ç•°å¸¸é«˜ï¼Œå¯èƒ½å­˜åœ¨ä½œå¼Šè¡Œç‚º');
      // è¨˜éŒ„å¯ç–‘æ´»å‹•
      SecurityLogger.logSuspiciousActivity('high_score', { score });
    }
    
    return true;
  }
  
  static sanitizeUserInput(input) {
    if (typeof input !== 'string') return '';
    
    // ç§»é™¤æ½›åœ¨å±éšªå­—ç¬¦
    return input
      .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
      .replace(/[<>]/g, '')
      .trim()
      .substring(0, 100); // é™åˆ¶é•·åº¦
  }
}
```

### è³‡æ–™å®Œæ•´æ€§

```javascript
// âœ… è³‡æ–™å®Œæ•´æ€§æª¢æŸ¥
class DataIntegrityChecker {
  static validateGameState(state) {
    const schema = {
      score: 'number',
      isPlaying: 'boolean',
      startTime: 'number',
      duration: 'number'
    };
    
    for (const [key, expectedType] of Object.entries(schema)) {
      if (!(key in state)) {
        throw new Error(`ç¼ºå°‘å¿…è¦æ¬„ä½: ${key}`);
      }
      
      if (typeof state[key] !== expectedType) {
        throw new Error(`æ¬„ä½ ${key} å‹åˆ¥éŒ¯èª¤ï¼ŒæœŸæœ› ${expectedType}`);
      }
    }
    
    // é‚è¼¯ä¸€è‡´æ€§æª¢æŸ¥
    if (state.isPlaying && state.startTime > Date.now()) {
      throw new Error('éŠæˆ²é–‹å§‹æ™‚é–“ä¸èƒ½åœ¨æœªä¾†');
    }
    
    return true;
  }
}
```

## ğŸ“ˆ æŒçºŒæ”¹é€²

### ç¨‹å¼ç¢¼å¯©æŸ¥æª¢æŸ¥æ¸…å–®

- [ ] **åŠŸèƒ½æ€§**: ç¨‹å¼ç¢¼æ˜¯å¦æ­£ç¢ºå¯¦ä½œéœ€æ±‚ï¼Ÿ
- [ ] **å¯è®€æ€§**: ç¨‹å¼ç¢¼æ˜¯å¦æ˜“æ–¼ç†è§£ï¼Ÿ
- [ ] **æ•ˆèƒ½**: æ˜¯å¦å­˜åœ¨æ•ˆèƒ½ç“¶é ¸ï¼Ÿ
- [ ] **å®‰å…¨æ€§**: æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ï¼Ÿ
- [ ] **æ¸¬è©¦**: æ˜¯å¦æœ‰è¶³å¤ çš„æ¸¬è©¦è¦†è“‹ï¼Ÿ
- [ ] **æ–‡æª”**: æ˜¯å¦æœ‰é©ç•¶çš„è¨»è§£å’Œæ–‡æª”ï¼Ÿ

### é‡æ§‹æŒ‡æ¨™

ç•¶æ»¿è¶³ä»¥ä¸‹æ¢ä»¶æ™‚æ‡‰è€ƒæ…®é‡æ§‹ï¼š

```yaml
refactoring_triggers:
  function_length: "> 50 lines"
  cyclomatic_complexity: "> 10"
  duplicate_code: "> 3 occurrences"
  test_coverage: "< 70%"
  bug_frequency: "> 2 per week"
  modification_frequency: "> 5 times per month"
```

### æŠ€è¡“å‚µå‹™ç®¡ç†

```javascript
// âœ… æŠ€è¡“å‚µå‹™æ¨™è¨˜
/**
 * @TODO: é‡æ§‹æ­¤å‡½æ•¸ä»¥æ”¹å–„æ•ˆèƒ½
 * @DEBT: å¾ªç’°è¤‡é›œåº¦éé«˜ (ç•¶å‰: 12, ç›®æ¨™: â‰¤10)
 * @PRIORITY: High
 * @EFFORT: 4 hours
 * @RISK: Medium - å½±éŸ¿éŠæˆ²ä¸»è¦æµç¨‹
 */
function complexGameLogic() {
  // è¤‡é›œé‚è¼¯...
}
```

---

**ğŸ¯ å“è³ªç›®æ¨™**: ç¶­æŒé«˜å“è³ªç¨‹å¼ç¢¼ï¼Œç¢ºä¿é•·æœŸå¯ç¶­è­·æ€§  
**ğŸ“Š ç›£æ§é »ç‡**: æ¯æ¬¡æäº¤è‡ªå‹•æª¢æŸ¥ï¼Œæ¯é€±äººå·¥å¯©æŸ¥  
**ğŸ”„ æ›´æ–°é€±æœŸ**: æ¯æœˆæª¢è¨å’Œæ›´æ–°å“è³ªæ¨™æº–